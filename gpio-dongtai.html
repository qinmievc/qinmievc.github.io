<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta charset="UTF-8">
		<title>GPIO 八种模式 · 课堂讲解系统</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<style>
			body {
				margin: 0;
				font-family: "Segoe UI", Arial;
				background: #020617;
				color: #e5e7eb;
			}

			.top {
				padding: 15px;
				display: flex;
				flex-wrap: wrap;
				gap: 10px;
				justify-content: center;
				background: #020617;
				border-bottom: 1px solid #1e293b;
			}

			.mode-btn {
				padding: 8px 14px;
				border-radius: 20px;
				border: 1px solid #334155;
				background: #0f172a;
				color: #e5e7eb;
				cursor: pointer;
				font-weight: 600;
			}

			.mode-btn.active {
				background: #38bdf8;
				color: #020617;
			}

			.container {
				display: grid;
				grid-template-columns: 2fr 1fr;
				height: calc(100vh - 70px);
			}

			.left {
				display: flex;
				justify-content: center;
				align-items: center;
			}

			.right {
				padding: 30px;
				background: #020617;
			}

			h1 {
				font-size: 1.5rem;
				color: #38bdf8;
			}

			.step-text {
				margin-top: 20px;
				line-height: 1.7;
				font-size: 1.05rem;
			}

			.controls {
				margin-top: 30px;
			}

			button {
				padding: 10px 18px;
				margin-right: 10px;
				border: none;
				border-radius: 8px;
				font-weight: 600;
				cursor: pointer;
				background: #38bdf8;
				color: #020617;
			}

			button:disabled {
				opacity: .4
			}

			/* ===== SVG ===== */
			@keyframes current {
				0% {
					stroke-dashoffset: 20
				}

				100% {
					stroke-dashoffset: 0
				}
			}

			.dim {
				opacity: .15
			}
		</style>
	</head>

	<body>

		<!-- 模式选择 -->
		<div class="top" id="modeBar"></div>

		<div class="container">

			<!-- 左：电路 -->
			<div class="left">
				<svg width="600" height="360" viewBox="0 0 600 360">

					<!-- VDD -->
					<text x="60" y="30" fill="#22c55e">VDD</text>
					<line x1="80" y1="40" x2="80" y2="140" stroke="#22c55e" stroke-width="4" id="vdd" />

					<!-- 上拉 -->
					<line x1="80" y1="140" x2="120" y2="180" stroke="#22c55e" stroke-width="4" id="pullup" />

					<!-- 下拉 -->
					<line x1="80" y1="220" x2="120" y2="180" stroke="#ef4444" stroke-width="4" id="pulldown" />

					<!-- GND -->
					<text x="60" y="320" fill="#ef4444">GND</text>
					<line x1="80" y1="220" x2="80" y2="310" stroke="#ef4444" stroke-width="4" id="gnd" />

					<!-- ADC -->
					<circle cx="120" cy="180" r="25" fill="#facc15" id="adc" />
					<text x="120" y="185" text-anchor="middle" fill="#020617">ADC</text>

					<!-- GPIO -->
					<line x1="145" y1="180" x2="380" y2="180" stroke="#38bdf8" stroke-width="5" stroke-dasharray="8 6"
						id="gpio" />

					<circle cx="380" cy="180" r="18" fill="#38bdf8" />
					<text x="380" y="215" fill="#e5e7eb" text-anchor="middle">GPIO</text>

					<!-- 外设 -->
					<rect x="420" y="150" width="100" height="60" rx="8" fill="#a855f7" id="af" />
					<text x="470" y="185" fill="#020617" text-anchor="middle">AF</text>

				</svg>
			</div>

			<!-- 右：讲解 -->
			<div class="right">
				<h1 id="title"></h1>
				<div class="step-text" id="text"></div>
				<div class="controls">
					<button id="prev">上一步</button>
					<button id="next">下一步</button>
				</div>
			</div>

		</div>

		<script>
			const elements = ["vdd", "gnd", "pullup", "pulldown", "adc", "gpio", "af"]
				.map(id => document.getElementById(id));

			function dimAll() {
				elements.forEach(e => {
					e.classList.add("dim");
					e.style.animation = "";
				});
			}

			const modes = [{
					name: "模拟输入",
					steps: [
						["连接 ADC，引脚进入高阻态。", () => {
							dimAll();
							adc.classList.remove("dim");
						}],
						["模拟电压直接送入 ADC 采样。", () => {
							dimAll();
							adc.classList.remove("dim");
							gpio.classList.remove("dim");
							gpio.style.animation = "current 1s linear infinite";
						}]
					]
				},
				{
					name: "浮空输入",
					steps: [
						["GPIO 为高阻态，没有上拉下拉。", () => {
							dimAll();
						}],
						["引脚容易受外界干扰，电平不稳定。", () => {
							dimAll();
						}]
					]
				},
				{
					name: "上拉输入",
					steps: [
						["内部上拉电阻接 VDD。", () => {
							dimAll();
							pullup.classList.remove("dim");
							vdd.classList.remove("dim");
						}],
						["默认读到高电平。", () => {
							dimAll();
							pullup.classList.remove("dim");
							gpio.classList.remove("dim");
						}]
					]
				},
				{
					name: "下拉输入",
					steps: [
						["内部下拉电阻接 GND。", () => {
							dimAll();
							pulldown.classList.remove("dim");
							gnd.classList.remove("dim");
						}],
						["默认读到低电平。", () => {
							dimAll();
							pulldown.classList.remove("dim");
							gpio.classList.remove("dim");
						}]
					]
				},
				{
					name: "推挽输出",
					steps: [
						["GPIO 配置为推挽输出。", () => {
							dimAll();
						}],
						["输出高电平：由 VDD 驱动。", () => {
							dimAll();
							vdd.classList.remove("dim");
							gpio.classList.remove("dim");
							gpio.style.animation = "current .7s linear infinite";
						}],
						["输出低电平：拉向 GND。", () => {
							dimAll();
							gnd.classList.remove("dim");
							gpio.classList.remove("dim");
							gpio.style.animation = "current .7s linear infinite";
						}]
					]
				},
				{
					name: "开漏输出",
					steps: [
						["只能主动拉低。", () => {
							dimAll();
						}],
						["低电平时接 GND。", () => {
							dimAll();
							gnd.classList.remove("dim");
							gpio.classList.remove("dim");
						}]
					]
				},
				{
					name: "复用推挽",
					steps: [
						["外设接管 GPIO。", () => {
							dimAll();
							af.classList.remove("dim");
						}],
						["外设以推挽方式输出。", () => {
							dimAll();
							af.classList.remove("dim");
							gpio.classList.remove("dim");
							gpio.style.animation = "current .7s linear infinite";
						}]
					]
				},
				{
					name: "复用开漏",
					steps: [
						["外设接管 GPIO。", () => {
							dimAll();
							af.classList.remove("dim");
						}],
						["外设只能拉低总线。", () => {
							dimAll();
							af.classList.remove("dim");
							gnd.classList.remove("dim");
							gpio.classList.remove("dim");
						}]
					]
				}
			];

			let mode = 0,
				step = 0;
			const title = document.getElementById("title");
			const text = document.getElementById("text");

			function render() {
				title.innerText = modes[mode].name;
				text.innerHTML = `【Step ${step+1}】` + modes[mode].steps[step][0];
				modes[mode].steps[step][1]();
				prev.disabled = step === 0;
				next.disabled = step === modes[mode].steps.length - 1;
			}

			document.getElementById("prev").onclick = () => {
				step--;
				render()
			}
			document.getElementById("next").onclick = () => {
				step++;
				render()
			}

			const bar = document.getElementById("modeBar");
			modes.forEach((m, i) => {
				const b = document.createElement("button");
				b.className = "mode-btn";
				b.innerText = m.name;
				b.onclick = () => {
					document.querySelectorAll(".mode-btn").forEach(x => x.classList.remove("active"));
					b.classList.add("active");
					mode = i;
					step = 0;
					render();
				};
				if (i === 0) b.classList.add("active");
				bar.appendChild(b);
			});

			render();
		</script>
	</body>
</html>